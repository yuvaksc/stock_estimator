# üìà Stock Price Estimator

This project predicts stock prices using a multimodal approach that combines historical stock data and sentiment from tweets. It leverages deep learning models to capture both market trends and public sentiment, aiming for more accurate stock price estimations.

## üìÇ Project Structure

The project is organized into the following directories:

- **`branches/`**: Contains the core model implementations, divided into three main branches:
    - **Branch 1**: Processes historical stock data.
    - **Branch 2**: Extracts and processes sentiment from tweets.
    - **Branch 3**: Merges the outputs of the first two branches and makes the final price prediction.
- **`pp/`**: Includes scripts for data preprocessing, such as cleaning tweets, extracting financial indicators, and performing dimensionality reduction.
- **`stock_data/`**: Stores all the data used in the project, including:
    - **`historical_csv/`**: Raw historical stock data.
    - **`new_sentiment_embeddings/`**: Processed tweet sentiment embeddings.
    - **`pca_historical_csv/`**: Historical data after applying PCA.
    - **`price/`**: Stock price data.
    - **`processed_tweets/`**: Cleaned tweet data.
- **`test_merged_tensors/`** and **`test_tensors/`**: Contain tensor data used for testing the models.

## ‚öôÔ∏è Workflow

The project follows a three-branch workflow to predict stock prices:

### 1. Data Preprocessing

- **Tweet Cleaning (`pp/tweet_clean.py`)**: Raw tweets are cleaned by removing URLs, mentions, and hashtags.
- **Indicator Extraction (`pp/extract_indicators.py`)**: Financial indicators (e.g., SMA, EMA, RSI) are calculated from historical stock data.
- **Dimensionality Reduction (`pp/autoencoder.py`)**: PCA is applied to the financial indicators to reduce their dimensionality.
- **Data Merging (`pp/mergeLatent.py`)**: The preprocessed historical data and indicators are merged.

### 2. Model Training and Prediction

The core of the project is a three-branch model:

- **Branch 1: Historical Data Analysis**
    - **`branches/branch11.py`**: A Bi-LSTM with Attention model is trained on the historical stock data (including the PCA-reduced indicators) to learn market trends.
    - **`branches/branch12.py`**: The trained model from `branch11.py` is used to generate feature vectors for each stock.

- **Branch 2: Tweet Sentiment Analysis**
    - **`branches/branch21.py`**: BERT is used to generate embeddings for the cleaned tweets. TF-IDF is used to aggregate the embeddings for each day.
    - **`branches/branch22.py`**: The daily tweet embeddings are interpolated to fill in any missing dates.

- **Branch 3: Multimodal Fusion and Prediction**
    - **`branches/branch31.py`**: The feature vectors from Branch 1 and the tweet embeddings from Branch 2 are merged.
    - **`branches/branch32.py`**: A multimodal regressor model is trained on the merged data to predict the final stock price. This model uses Transformer encoders to process the data from both branches.
    - **`branches/branch33.py`**: The trained model from `branch32.py` is used to make predictions on the test data, and the results are plotted.

## üõ†Ô∏è Installation Dependencies

To run this project, you need to install the following dependencies:

- `torch`
- `pandas`
- `numpy`
- `scikit-learn`
- `tqdm`
- `pandas-ta`
- `matplotlib`
- `transformers`

You can install them using pip:

```bash
pip install torch pandas numpy scikit-learn tqdm pandas-ta matplotlib transformers
```

## üöÄ How to Run

1.  **Set up the environment**: Make sure you have all the required libraries installed.
2.  **Run the preprocessing scripts**: Execute the scripts in the `pp/` directory in the following order:
    1.  `tweet_clean.py`
    2.  `extract_indicators.py`
    3.  `autoencoder.py`
    4.  `mergeLatent.py`
3.  **Run the model branches**: Execute the scripts in the `branches/` directory in the following order:
    1.  `branch11.py`
    2.  `branch12.py`
    3.  `branch21.py`
    4.  `branch22.py`
    5.  `branch31.py`
    6.  `branch32.py`
    7.  `branch33.py`

The final predictions will be generated by `branch33.py`.
